<html>
<head>
    <title>My Blog</title>
    {% extends html/layout.html %}
</head>

<body id="body" onload="prettyPrint()" ng-app="myApp" ng-controller="myCtrl">
    
    {% extends html/nav.html %}
    
        <header>           
            <div class="header-content">
                <div class="header-content-inner">
                    <h1>{{blogPost.title}}</h1>
                    <p>Welcome to my blog!</p>
                </div>
            </div>
        </header>
        <hr class="heavy">
        
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading">{{blogPost.title}}</h2>
                    <h3>{{blogPost.date|date: 'dd.MM.yyyy HH:mm'}}</h3>
                    <hr class="heavy">
                    <br><br>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div ng-bind-html="textBody"></div>
                </div>  
            </div>
        </div>
        
    <script>      
        var app = angular.module('myApp', ['ngSanitize']);
        app.controller('myCtrl', function($scope, $http, $location) {                                    
            $scope.getBlog = function (id)
            {
                $http.get("get-blog?id=" + id).then(function(response) {
                    $scope.blogPost = response.data;
                    $scope.textBody =  $scope.blogPost.text;                    
                    $("header").css('background-image', 'url('+ $scope.blogPost.image+ ')');
                    
                    setTimeout(function() {  
                        $("#body").find("pre").addClass('prettyprint');
                        prettyPrint(); 
                    }, 100);
                });
            }
            
            var query = $location.search();
            $scope.getBlog(query.id);
        });
    </script>
</body>

